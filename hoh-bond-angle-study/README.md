# Hâ€“Oâ€“H Angle Deformation in Water: Energy Profile

This project investigates how the potential energy of a single water molecule changes with variations in the **Hâ€“Oâ€“H bond angle**. Using **Density Functional Theory (DFT)** calculations performed in [ORCA](https://www.faccts.de/orca/),[single-point energies](https://atomistica.online/course-what-is-molecular-modeling/part-2-introduction-to-single-point-energy-calculations/) were computed across a range of fixed angles to generate a detailed **energy profile** of angular deformation.

---

## Optimized Structure

The image below shows the geometry of a single water molecule used in this study:

![Optimized Water](./water.jpg)

---

## Methodology

- **System**: Single Hâ‚‚O molecule  
- **Software**: ORCA for quantum chemistry; Python [Google Colab](https://colab.research.google.com) for analysis  
- **Procedure**:
  - Begin from the optimized geometry of Hâ‚‚O (equilibrium Hâ€“Oâ€“H angle â‰ˆ 105.2Â°)
  - Fix Oâ€“H bond lengths and vary the **Hâ€“Oâ€“H bond angle** from 60Â° to 180Â° in 0.1Â° steps
  - Perform **single-point energy calculations** at each angle
  - Visualize and fit the energy curve using Google Colab.
 
---

## Input/Output Files
Over 300 ORCA input/output files were generated by scanning the Hâ€“Oâ€“H bond angle.

To explore a sample configuration:

ğŸ”¹ Input:  [angle_water.inp](./H2O_angle_0096p6.inp)  
ğŸ”¹ Output: [angle_water.out](./H2O_angle_0096p6.out)


---

## Hâ€“Oâ€“H Angle Energy Profile

This figure illustrates how the energy of a water molecule changes with angle deformation:

**Access or retrieve** the raw input data: [angle_energy_data.csv](./angle_energy_data.csv)

![Hâ€“Oâ€“H Energy Curve](./energy_curve.png)

---

**Interaction Behavior**:
- **Repulsion**: Angle = 60Â° â†’ High energy due to strong steric repulsion  
- **Equilibrium**: Angle â‰ˆ 105.2Â° â†’ Minimum energy configuration  
- **Deformation**: Angle = 180Â° â†’ Higher energy due to orbital strain  

---

## Energy Curve Fitting and Force Constant

To quantify the stiffness of **the Hâ€“Oâ€“H angle** in a water molecule, we performed a parabolic fit around the energy minimum.


**visualize or download** the raw data used: [View notebook: Angle_forceconst.ipynb](./Angle_forceconst.ipynb)
 

## A zoomed-in plot near the energy minimum 

**Plot or export** the source data: [angle_energy_near minimum.csv](./hoh_angle_energy_data_const.csv)


![Parabolic Fit (near minimum)](./Parabolic_fits_near_minimum.png)

---

# ğŸ’§ Angular Force Constant & Bond Angle Analysis of Water Models

This project uses DFT data to calculate the angular force constant \( k_\theta \) of water and compares it with values from widely used water models. It provides clear visuals, a scientific explanation, and tools for applying your own data.

---

## ğŸ§ª How Is \( k_\theta \) Calculated?

We apply the harmonic approximation:

\[
\Delta E = \frac{1}{2} k_\theta (\Delta \theta)^2
\]

**Inputs from DFT:**
- Equilibrium angle: \( \theta_0 = 105.24^\circ \)
- Perturbed angle: \( \theta_1 = 104.24^\circ \)
- Energies:  
  \( E_0 = -76.42636593 \),  
  \( E_1 = -76.42634167 \) Hartree

**Step-by-step:**

1. **Energy difference**  
   \( \Delta E = E_1 - E_0 = 0.00002426 \) Hartree  
2. **Angle change**  
   \( \Delta \theta = -1.00^\circ = -0.01745 \) rad  
3. **Force constant**  
   \[
   k_\theta = \frac{2 \Delta E}{(\Delta \theta)^2} = 0.15928 \, \text{Hartree/rad}^2
   \]
4. **Conversions**  
   - \( 0.15928 \times 627.5095 = 99.95 \, \text{kcal/mol/rad}^2 \)  
   - \( 99.95 / 3282.81 = 0.03045 \, \text{kcal/mol/deg}^2 \)

âœ… This makes it compatible with **LAMMPS-style angle potentials**.

---

## ğŸ“˜ What This Project Includes

- ğŸ“ **Angular Force Constant Calculator**  
  A Python script to compute \( k_\theta \) from your DFT energies.

- ğŸ“ **Bond Angle Comparison Plot**  
  Horizontal bar chart showing Hâ€“Oâ€“H angles across water models.

- ğŸ“‰ **k_theta Comparison Plot**  
  Visual comparison of angular stiffness (kcal/mol/radÂ²).

- ğŸ“¦ **High-resolution outputs**  
  Plots and tables are saved as `.jpg` for presentation use.

---

## ğŸ“Š Sample Visuals

| Angular Stiffness | Bond Angle Comparison |
|-------------------|------------------------|
| `plot_horizontal_bar_corrected.jpg` | `equilibrium_angles_plot_highlighted.jpg` |

---

## ğŸ“ Repository Files

- `water_models_k_theta_angle_analysis.ipynb`: Main notebook  
- `water_force_constants_table.jpg`: Summary table of models  
- `plot_horizontal_bar_corrected.jpg`: Comparison of kÎ¸  
- `equilibrium_angles_plot_highlighted.jpg`: Comparison of bond angles (with DFT fit highlighted)

---

## ğŸ§¬ Use Your Own Data

Modify this block in the notebook or script:

```python
theta_0_deg = 105.24     # equilibrium angle
theta_1_deg = 104.24     # perturbed angle
E_0 = -76.42636593       # DFT energy at equilibrium
E_1 = -76.42634167       # DFT energy at perturbed angle




## ğŸ§ª How Is \( k_\theta \) Calculated?

We apply the harmonic approximation:

\[
\Delta E = \frac{1}{2} k_\theta (\Delta \theta)^2
\]

**Inputs from DFT:**

- Equilibrium angle: \( \theta_0 = 105.24^\circ \)  
- Perturbed angle: \( \theta_1 = 104.24^\circ \)  
- Energies:  
  \( E_0 = -76.42636593 \, \text{Hartree} \)  
  \( E_1 = -76.42634167 \, \text{Hartree} \)

---

### ğŸ”¢ Step-by-Step Calculation

**1. Energy Difference**

\[
\Delta E = E_1 - E_0 = -76.42634167 - (-76.42636593) = 0.00002426 \, \text{Hartree}
\]

**2. Angle Deviation**

\[
\Delta \theta = \theta_1 - \theta_0 = -1.00^\circ = -0.01745 \, \text{rad}
\]

**3. Force Constant in Hartree/radÂ²**

\[
k_\theta = \frac{2 \Delta E}{(\Delta \theta)^2} = \frac{2 \times 0.00002426}{(0.01745)^2} = 0.15928 \, \text{Hartree/rad}^2
\]

**4. Convert to kcal/mol/radÂ²**

\[
k_\theta = 0.15928 \times 627.5095 = 99.95 \, \text{kcal/mol/rad}^2
\]

**5. Convert to kcal/mol/degÂ²**

\[
1 \, \text{rad}^2 = \left( \frac{180}{\pi} \right)^2 \approx 3282.81 \, \text{deg}^2
\]

\[
k_\theta = \frac{99.95}{3282.81} = 0.03045 \, \text{kcal/mol/deg}^2
\]



## Author

Created by: **Handson Gisubizo**  
 GitHub: [https://github.com/handsongisubizo](https://github.com/handsongisubizo)
